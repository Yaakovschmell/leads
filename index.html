<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Training Scheduler</title>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Segoe UI',system-ui,sans-serif;background:#0f1117;color:#e8eaf0;min-height:100vh}
header{background:linear-gradient(135deg,#1a1d27,#0f1117);border-bottom:1px solid #2e3250;padding:14px 24px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100}
.logo{display:flex;align-items:center;gap:12px}
.logo-icon{width:36px;height:36px;background:linear-gradient(135deg,#6c63ff,#00d4aa);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:18px}
.logo h1{font-size:1.1rem;font-weight:700}
.logo p{font-size:.7rem;color:#7a7f9a;margin-top:1px}
.header-right{display:flex;gap:10px;align-items:center}
.week-nav{display:flex;align-items:center;gap:6px;background:#21253a;border:1px solid #2e3250;border-radius:10px;padding:5px 10px}
.week-nav button{background:none;border:none;color:#7a7f9a;cursor:pointer;font-size:18px;padding:0 4px;border-radius:5px;transition:all .15s}
.week-nav button:hover{background:#2e3250;color:#e8eaf0}
.week-nav span{font-size:.82rem;font-weight:600;min-width:155px;text-align:center}
.save-badge{font-size:.72rem;padding:5px 12px;border-radius:20px;background:#21253a;border:1px solid #2e3250;color:#7a7f9a;display:flex;align-items:center;gap:5px;transition:all .3s}
.save-badge.saved{color:#00d4aa;border-color:#00d4aa}
.save-badge .dot{width:6px;height:6px;border-radius:50%;background:currentColor}
.layout{display:grid;grid-template-columns:215px 1fr;min-height:calc(100vh - 68px)}
aside{background:#1a1d27;border-right:1px solid #2e3250;padding:16px 12px;position:sticky;top:68px;height:calc(100vh - 68px);overflow-y:auto;scrollbar-width:thin}
aside h2{font-size:.65rem;text-transform:uppercase;letter-spacing:1.2px;color:#7a7f9a;margin-bottom:10px;padding:0 4px}
.pool{display:flex;flex-direction:column;gap:5px;min-height:20px}
.chip{display:flex;align-items:center;gap:8px;padding:8px 10px;border-radius:9px;cursor:grab;font-size:.84rem;font-weight:500;border:1px solid transparent;user-select:none;transition:all .15s}
.chip:hover{filter:brightness(1.2)}
.chip:active{cursor:grabbing;transform:scale(.97)}
.chip.dragging{opacity:.3}
.avatar{width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.6rem;font-weight:700;color:#fff;flex-shrink:0}
.add-section{margin-top:14px;padding-top:12px;border-top:1px solid #2e3250}
.add-section label{font-size:.65rem;color:#7a7f9a;display:block;margin-bottom:5px;text-transform:uppercase;letter-spacing:.8px}
.add-section input{width:100%;background:#21253a;border:1px solid #2e3250;color:#e8eaf0;padding:7px 9px;border-radius:7px;font-size:.84rem;outline:none;transition:border-color .2s}
.add-section input:focus{border-color:#6c63ff}
.add-section button{margin-top:6px;width:100%;padding:7px;background:#6c63ff;color:#fff;border:none;border-radius:7px;font-size:.84rem;font-weight:600;cursor:pointer;transition:opacity .15s}
.add-section button:hover{opacity:.85}
main{padding:20px;overflow-x:auto}
.stats{display:flex;gap:10px;margin-bottom:18px;flex-wrap:wrap}
.stat{background:#1a1d27;border:1px solid #2e3250;border-radius:9px;padding:9px 14px;min-width:100px}
.stat .sl{font-size:.62rem;color:#7a7f9a;text-transform:uppercase;letter-spacing:.8px}
.stat .sv{font-size:1.2rem;font-weight:700;margin-top:2px}
.grid{display:grid;grid-template-columns:repeat(5,1fr);gap:12px;min-width:700px}
.day-col{background:#1a1d27;border:1px solid #2e3250;border-radius:13px;overflow:hidden}
.day-head{padding:11px 14px;background:#21253a;border-bottom:1px solid #2e3250}
.day-head .dn{font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:#6c63ff}
.day-head .dd{font-size:.66rem;color:#7a7f9a;margin-top:2px}
.slots{padding:8px;display:flex;flex-direction:column;gap:7px}
.slot{background:#1e2235;border:1.5px dashed #2e3250;border-radius:9px;min-height:78px;padding:7px;transition:all .2s;position:relative}
.slot.over{border-color:#6c63ff;background:#6c63ff15;transform:scale(1.02)}
.slot.filled{border-style:solid;border-color:transparent;background:#21253a}
.slot-lbl{font-size:.6rem;color:#7a7f9a;text-transform:uppercase;letter-spacing:.7px;margin-bottom:4px}
.slot-cnt{position:absolute;top:6px;right:7px;font-size:.6rem;color:#7a7f9a}
.trainee-row{display:flex;align-items:center;justify-content:space-between;padding:5px 7px;border-radius:6px;font-size:.78rem;font-weight:500;cursor:grab;margin-bottom:3px}
.trainee-row:active{cursor:grabbing}
.trainee-row .ti{display:flex;align-items:center;gap:6px}
.trainee-row .rm{background:none;border:none;color:#7a7f9a;cursor:pointer;font-size:14px;padding:0 2px;opacity:0;transition:opacity .15s,color .15s}
.trainee-row:hover .rm{opacity:1}
.trainee-row .rm:hover{color:#ff5c5c}
.hint{font-size:.68rem;color:#7a7f9a;text-align:center;padding:8px 0;opacity:.5}
.rec{margin-top:5px;display:flex;align-items:center;gap:4px}
.rec input{flex:1;background:#181c2e;border:1px solid #2e3250;color:#e8eaf0;padding:4px 7px;border-radius:5px;font-size:.65rem;outline:none;min-width:0}
.rec input::placeholder{color:#4a4f6a}
.rec input:focus{border-color:#00d4aa}
.rec a{color:#00d4aa;text-decoration:none;font-size:14px;flex-shrink:0;opacity:.85}
.rec a:hover{opacity:1}
.toast{position:fixed;bottom:22px;right:22px;background:#21253a;border:1px solid #2e3250;color:#e8eaf0;padding:11px 16px;border-radius:9px;font-size:.82rem;box-shadow:0 8px 32px rgba(0,0,0,.5);transform:translateY(70px);opacity:0;transition:all .3s cubic-bezier(.175,.885,.32,1.275);z-index:9999}
.toast.show{transform:translateY(0);opacity:1}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-thumb{background:#2e3250;border-radius:99px}
</style>
</head>
<body>

<header>
  <div class="logo">
    <div class="logo-icon">ðŸŽ¯</div>
    <div>
      <h1>Training Scheduler</h1>
      <p>Drag names Â· Log recordings Â· Auto-saved</p>
    </div>
  </div>
  <div class="header-right">
    <div class="week-nav">
      <button id="prevW">â€¹</button>
      <span id="wkLabel"></span>
      <button id="nextW">â€º</button>
    </div>
    <div class="save-badge" id="badge">
      <span class="dot"></span><span id="badgeTxt">Auto-saved</span>
    </div>
  </div>
</header>

<div class="layout">
  <aside>
    <h2>Roster</h2>
    <div class="pool" id="pool"></div>
    <div class="add-section">
      <label>Add Person</label>
      <input id="nameIn" placeholder="Full nameâ€¦" maxlength="30"/>
      <button id="addBtn">+ Add to Roster</button>
    </div>
  </aside>
  <main>
    <div class="stats" id="stats"></div>
    <div class="grid" id="grid"></div>
  </main>
</div>

<div class="toast" id="toast"></div>

<script>
const DAYS=['Monday','Tuesday','Wednesday','Thursday','Friday'];
const SLOTS=3;
const COLORS=['#6c63ff','#f7971e','#00d4aa','#ff6b9d','#4ecdc4','#ffe66d','#a855f7','#ff8c00','#38bdf8','#f43f5e'];

let offset=0, roster=[], schedule={}, drag=null;

function ini(n){return n.split(' ').map(w=>w[0]).join('').toUpperCase().slice(0,2)}
function color(n){return(roster.find(r=>r.name===n)||{color:'#aaa'}).color}

function monday(off){
  const d=new Date(),day=d.getDay();
  d.setDate(d.getDate()-(day===0?6:day-1)+off*7);
  d.setHours(0,0,0,0);return d;
}
function wkKey(off){return'w'+monday(off).toISOString().slice(0,10)}
function fmtWeek(off){
  const m=monday(off),f=monday(off);
  f.setDate(f.getDate()+4);
  const o={month:'short',day:'numeric'};
  return m.toLocaleDateString('en-US',o)+' â€“ '+f.toLocaleDateString('en-US',o);
}
function dayDate(di,off){
  const m=monday(off);m.setDate(m.getDate()+di);
  return m.toLocaleDateString('en-US',{month:'short',day:'numeric'});
}

function slot(day,si){
  const k=wkKey(offset),key=day+'-'+si;
  if(!schedule[k])schedule[k]={};
  if(!schedule[k][key])schedule[k][key]={names:[],rec:''};
  return schedule[k][key];
}

// â”€â”€ SAVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let saveT;
function scheduleSave(){
  const b=document.getElementById('badge'),t=document.getElementById('badgeTxt');
  t.textContent='Savingâ€¦';b.classList.remove('saved');
  clearTimeout(saveT);
  saveT=setTimeout(()=>{
    localStorage.setItem('ts_r',JSON.stringify(roster));
    localStorage.setItem('ts_s',JSON.stringify(schedule));
    t.textContent='Auto-saved';b.classList.add('saved');
    setTimeout(()=>b.classList.remove('saved'),2500);
  },600);
}
function load(){
  try{roster=JSON.parse(localStorage.getItem('ts_r'))||[]}catch{roster=[]}
  try{schedule=JSON.parse(localStorage.getItem('ts_s'))||{}}catch{schedule={}}
  if(!roster.length)
    ['Tyler','Julie','Adam','Carnell','Kris','Cameron','Cynthia']
      .forEach((n,i)=>roster.push({name:n,color:COLORS[i]}));
}

// â”€â”€ TOAST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let tT;
function toast(msg){
  const el=document.getElementById('toast');
  el.textContent=msg;el.classList.add('show');
  clearTimeout(tT);tT=setTimeout(()=>el.classList.remove('show'),2800);
}

// â”€â”€ ROSTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderPool(){
  const p=document.getElementById('pool');p.innerHTML='';
  roster.forEach(({name,color:c})=>{
    const el=document.createElement('div');
    el.className='chip';el.draggable=true;el.dataset.name=name;
    el.style.background=c+'1a';
    el.innerHTML=`<div class="avatar" style="background:${c}">${ini(name)}</div><span>${name}</span>`;
    el.addEventListener('dragstart',e=>{drag={name,from:null};el.classList.add('dragging');e.dataTransfer.effectAllowed='move'});
    el.addEventListener('dragend',()=>el.classList.remove('dragging'));
    p.appendChild(el);
  });
}

// â”€â”€ GRID â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function render(){
  document.getElementById('wkLabel').textContent=fmtWeek(offset);
  const grid=document.getElementById('grid');grid.innerHTML='';
  DAYS.forEach((day,di)=>{
    const col=document.createElement('div');col.className='day-col';
    col.innerHTML=`<div class="day-head"><div class="dn">${day}</div><div class="dd">${dayDate(di,offset)}</div></div><div class="slots" id="s-${day}"></div>`;
    grid.appendChild(col);
    const sc=col.querySelector('#s-'+day);
    for(let si=0;si<SLOTS;si++) sc.appendChild(mkSlot(day,si));
  });
  renderStats();
}

function mkSlot(day,si){
  const d=slot(day,si);
  const el=document.createElement('div');
  el.className='slot'+(d.names.length?' filled':'');

  el.addEventListener('dragover',e=>{e.preventDefault();el.classList.add('over')});
  el.addEventListener('dragleave',()=>el.classList.remove('over'));
  el.addEventListener('drop',e=>{
    e.preventDefault();el.classList.remove('over');
    if(!drag)return;
    const t=slot(day,si);
    if(t.names.includes(drag.name))return;
    if(t.names.length>=1){toast('âš ï¸ Session already has a trainee');return}
    if(drag.from){
      const s=slot(drag.from.day,drag.from.si);
      s.names=s.names.filter(n=>n!==drag.name);
    }
    t.names.push(drag.name);
    drag=null;scheduleSave();render();renderPool();
  });

  const lbl=document.createElement('div');lbl.className='slot-lbl';lbl.textContent='Session '+(si+1);
  const cnt=document.createElement('div');cnt.className='slot-cnt';cnt.textContent=d.names.length+'/1';

  el.appendChild(lbl);el.appendChild(cnt);

  if(d.names.length===0){
    const h=document.createElement('div');h.className='hint';h.textContent='â†‘ Drop trainee here';el.appendChild(h);
  } else {
    d.names.forEach(name=>{
      const c=color(name);
      const row=document.createElement('div');row.className='trainee-row';row.draggable=true;
      row.style.cssText=`background:${c}22;border-left:3px solid ${c}`;
      row.innerHTML=`<div class="ti"><div class="avatar" style="background:${c};width:20px;height:20px;font-size:.58rem">${ini(name)}</div>${name}</div><button class="rm">Ã—</button>`;
      row.addEventListener('dragstart',e=>{drag={name,from:{day,si}};e.dataTransfer.effectAllowed='move'});
      row.querySelector('.rm').addEventListener('click',()=>{
        const s=slot(day,si);s.names=s.names.filter(n=>n!==name);
        scheduleSave();render();renderPool();
      });
      el.appendChild(row);
    });
  }

  // recording
  const rec=document.createElement('div');rec.className='rec';
  const inp=document.createElement('input');
  inp.type='url';inp.placeholder='ðŸŽ¥ Recording URLâ€¦';inp.value=d.rec||'';
  const lnk=document.createElement('a');lnk.target='_blank';lnk.textContent='â–¶';
  function updLnk(){const v=inp.value.trim();lnk.href=v||'#';lnk.style.display=v?'inline':'none'}
  updLnk();
  inp.addEventListener('input',()=>{d.rec=inp.value;scheduleSave();updLnk()});
  rec.appendChild(inp);rec.appendChild(lnk);el.appendChild(rec);
  return el;
}

function renderStats(){
  const bar=document.getElementById('stats');bar.innerHTML='';
  const wk=schedule[wkKey(offset)]||{};
  let total=0,withRec=0,filled=0;const pc={};
  DAYS.forEach(day=>{
    for(let si=0;si<SLOTS;si++){
      const d=wk[day+'-'+si];
      if(d&&d.names.length){filled++;d.names.forEach(n=>{pc[n]=(pc[n]||0)+1;total++});if(d.rec)withRec++}
    }
  });
  const all=DAYS.length*SLOTS,top=Object.entries(pc).sort((a,b)=>b[1]-a[1])[0];
  [
    {l:'Sessions',v:total,c:'#6c63ff'},
    {l:'Slots Filled',v:filled+'/'+all,c:'#00d4aa'},
    {l:'With Recordings',v:withRec,c:'#f7971e'},
    ...(top?[{l:'Most Sessions',v:top[0],c:'#ff6b9d'}]:[])
  ].forEach(({l,v,c})=>{
    const s=document.createElement('div');s.className='stat';
    s.innerHTML=`<div class="sl">${l}</div><div class="sv" style="color:${c}">${v}</div>`;
    bar.appendChild(s);
  });
}

// â”€â”€ EVENTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('addBtn').addEventListener('click',()=>{
  const inp=document.getElementById('nameIn'),name=inp.value.trim();
  if(!name)return;
  if(roster.find(r=>r.name.toLowerCase()===name.toLowerCase())){toast('âš ï¸ Already in roster');return}
  roster.push({name,color:COLORS[roster.length%COLORS.length]});
  inp.value='';scheduleSave();renderPool();toast('âœ… '+name+' added!');
});
document.getElementById('nameIn').addEventListener('keydown',e=>{if(e.key==='Enter')document.getElementById('addBtn').click()});
document.getElementById('prevW').addEventListener('click',()=>{offset--;render()});
document.getElementById('nextW').addEventListener('click',()=>{offset++;render()});

load();renderPool();render();
setTimeout(()=>toast('ðŸ‘‹ Drag names from the sidebar into sessions!'),600);
</script>
</body>
</html>
